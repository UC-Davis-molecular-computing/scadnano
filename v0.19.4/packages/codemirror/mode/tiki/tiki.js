(function(k){"object"==typeof exports&&"object"==typeof module?k(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],k):k(CodeMirror)})(function(k){k.defineMode("tiki",function(y){function f(a,b,c){return function(g,m){for(;!g.eol();){if(g.match(b)){m.tokenize=e;break}g.next()}c&&(m.tokenize=c);return a}}function u(a){return function(b,c){for(;!b.eol();)b.next();c.tokenize=e;return a}}function e(a,b){function c(v){b.tokenize=v;return v(a,b)}var g=
a.sol(),m=a.next();switch(m){case "{":return a.eat("/"),a.eatSpace(),a.eatWhile(/[^\s\u00a0="'\/?(}]/),b.tokenize=q,"tag";case "_":if(a.eat("_"))return c(f("strong","__",e));break;case "'":if(a.eat("'"))return c(f("em","''",e));break;case "(":if(a.eat("("))return c(f("variable-2","))",e));break;case "[":return c(f("variable-3","]",e));case "|":if(a.eat("|"))return c(f("comment","||"));break;case "-":if(a.eat("="))return c(f("header string","=-",e));if(a.eat("-"))return c(f("error tw-deleted","--",
e));break;case "=":if(a.match("=="))return c(f("tw-underline","===",e));break;case ":":if(a.eat(":"))return c(f("comment","::"));break;case "^":return c(f("tw-box","^"));case "~":if(a.match("np~"))return c(f("meta","~/np~"))}if(g)switch(m){case "!":return a.match("!!!!!")||a.match("!!!!")||a.match("!!!")||a.match("!!"),c(u("header string"));case "*":case "#":case "+":return c(u("tw-listitem bracket"))}return null}function q(a,b){var c=a.next(),g=a.peek();if("}"==c)return b.tokenize=e,"tag";if("("==
c||")"==c)return"bracket";if("="==c)return p="equals",">"==g&&(a.next(),g=a.peek()),/['"]/.test(g)||(b.tokenize=z()),"operator";if(/['"]/.test(c))return b.tokenize=A(c),b.tokenize(a,b);a.eatWhile(/[^\s\u00a0="'\/?]/);return"keyword"}function A(a){return function(b,c){for(;!b.eol();)if(b.next()==a){c.tokenize=q;break}return"string"}}function z(){return function(a,b){for(;!a.eol();){var c=a.next(),g=a.peek();if(" "==c||","==c||/[ )}]/.test(g)){b.tokenize=q;break}}return"string"}}function n(){for(var a=
arguments.length-1;0<=a;a--)d.cc.push(arguments[a])}function h(){n.apply(null,arguments);return!0}function w(a,b){d.context={prev:d.context,pluginName:a,indent:d.indented,startOfLine:b,noIndent:d.context&&d.context.noIndent}}function B(a){if("openPlugin"==a)return d.pluginName=r,h(t,C(d.startOfLine));if("closePlugin"==a)return d.context?(a=d.context.pluginName!=r,d.context&&(d.context=d.context.prev)):a=!0,a&&(l="error"),h(D(a));"string"==a&&(d.context&&"!cdata"==d.context.name||w("!cdata"),d.tokenize==
e&&d.context&&(d.context=d.context.prev));return h()}function C(a){return function(b){if("selfclosePlugin"==b||"endPlugin"==b)return h();"endPlugin"==b&&w(d.pluginName,a);return h()}}function D(a){return function(b){a&&(l="error");return"endPlugin"==b?h():n()}}function t(a){return"keyword"==a?(l="attribute",h(t)):"equals"==a?h(E,t):n()}function E(a){return"keyword"==a?(l="string",h()):"string"==a?h(x):n()}function x(a){return"string"==a?h(x):n()}var F=y.indentUnit,r,p,d,l;return{startState:function(){return{tokenize:e,
cc:[],indented:0,startOfLine:!0,pluginName:null,context:null}},token:function(a,b){a.sol()&&(b.startOfLine=!0,b.indented=a.indentation());if(a.eatSpace())return null;l=p=r=null;if(((a=b.tokenize(a,b))||p)&&"comment"!=a)for(d=b;!(b.cc.pop()||B)(p||a););b.startOfLine=!1;return l||a},indent:function(a,b){if((a=a.context)&&a.noIndent)return 0;a&&/^{\//.test(b)&&(a=a.prev);for(;a&&!a.startOfLine;)a=a.prev;return a?a.indent+F:0},electricChars:"/"}});k.defineMIME("text/tiki","tiki")});
