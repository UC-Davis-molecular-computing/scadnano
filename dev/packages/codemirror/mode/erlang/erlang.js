(function(l){"object"==typeof exports&&"object"==typeof module?l(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],l):l(CodeMirror)})(function(l){l.defineMIME("text/x-erlang","erlang");l.defineMode("erlang",function(z){function A(a,b){if(b.in_string)return b.in_string=!q(a,'"',"\\"),e(b,a,"string");if(b.in_atom)return b.in_atom=!q(a,"'","\\"),e(b,a,"atom");if(a.eatSpace())return e(b,a,"whitespace");if(!p(b)&&a.match(/-\s*[a-z\u00df-\u00f6\u00f8-\u00ff][\w\u00d8-\u00de\u00c0-\u00d6\u00df-\u00f6\u00f8-\u00ff]*/))return g(a.current(),
B)?e(b,a,"type"):e(b,a,"attribute");var c=a.next();if("%"==c)return a.skipToEnd(),e(b,a,"comment");if(":"==c)return e(b,a,"colon");if("?"==c)return a.eatSpace(),a.eatWhile(r),e(b,a,"macro");if("#"==c)return a.eatSpace(),a.eatWhile(r),e(b,a,"record");if("$"==c)return"\\"!=a.next()||a.match(C)?e(b,a,"number"):e(b,a,"error");if("."==c)return e(b,a,"dot");if("'"==c){if(!(b.in_atom=!q(a,"'","\\"))){if(a.match(/\s*\/\s*[0-9]/,!1))return a.match(/\s*\/\s*[0-9]/,!0),e(b,a,"fun");if(a.match(/\s*\(/,!1)||a.match(/\s*:/,
!1))return e(b,a,"function")}return e(b,a,"atom")}if('"'==c)return b.in_string=!q(a,'"',"\\"),e(b,a,"string");if(/[A-Z_\u00d8-\u00de\u00c0-\u00d6]/.test(c))return a.eatWhile(r),e(b,a,"variable");if(/[a-z_\u00df-\u00f6\u00f8-\u00ff]/.test(c)){a.eatWhile(r);if(a.match(/\s*\/\s*[0-9]/,!1))return a.match(/\s*\/\s*[0-9]/,!0),e(b,a,"fun");c=a.current();if(g(c,D))return e(b,a,"keyword");if(g(c,E))return e(b,a,"operator");if(a.match(/\s*\(/,!1))return!g(c,F)||":"==p(b).token&&"erlang"!=p(b,2).token?g(c,G)?
e(b,a,"guard"):e(b,a,"function"):e(b,a,"builtin");var d=a.match(/^\s*([^\s%])/,!1);return":"==(d?d[1]:"")?"erlang"==c?e(b,a,"builtin"):e(b,a,"function"):g(c,["true","false"])?e(b,a,"boolean"):e(b,a,"atom")}d=/[0-9]/;var f=/[0-9a-zA-Z]/;return d.test(c)?(a.eatWhile(d),a.eat("#")?a.eatWhile(f)||a.backUp(1):a.eat(".")&&(a.eatWhile(d)?a.eat(/[eE]/)&&(a.eat(/[-+]/)?a.eatWhile(d)||a.backUp(2):a.eatWhile(d)||a.backUp(1)):a.backUp(1)),e(b,a,"number")):w(a,H,u)?e(b,a,"open_paren"):w(a,I,x)?e(b,a,"close_paren"):
y(a,J,K)?e(b,a,"separator"):y(a,L,M)?e(b,a,"operator"):e(b,a,null)}function w(a,b,c){if(1==a.current().length&&b.test(a.current())){for(a.backUp(1);b.test(a.peek());)if(a.next(),g(a.current(),c))return!0;a.backUp(a.current().length-1)}return!1}function y(a,b,c){if(1==a.current().length&&b.test(a.current())){for(;b.test(a.peek());)a.next();for(;0<a.current().length;){if(g(a.current(),c))return!0;a.backUp(1)}a.next()}return!1}function q(a,b,c){for(;!a.eol();){var d=a.next();if(d==b)return!0;d==c&&a.next()}return!1}
function g(a,b){return-1<b.indexOf(a)}function e(a,b,c){var d=b.current();var f=b.column();b=b.indentation();d={token:d,column:f,indent:b,type:c};"comment"!=d.type&&"whitespace"!=d.type&&(f=a.tokenStack,b=f.length-1,0<b&&"record"===f[b].type&&"dot"===d.type?f.pop():(0<b&&"group"===f[b].type&&f.pop(),f.push(d)),a.tokenStack=f,a.tokenStack=N(a.tokenStack));switch(c){case "atom":return"atom";case "attribute":return"attribute";case "boolean":return"atom";case "builtin":return"builtin";case "close_paren":return null;
case "colon":return null;case "comment":return"comment";case "dot":return null;case "error":return"error";case "fun":return"meta";case "function":return"tag";case "guard":return"property";case "keyword":return"keyword";case "macro":return"variable-2";case "number":return"number";case "open_paren":return null;case "operator":return"operator";case "record":return"bracket";case "separator":return null;case "string":return"string";case "type":return"def";case "variable":return"variable";default:return null}}
function p(a,b){var c=a.tokenStack.length;b=b?b:1;return c<b?!1:a.tokenStack[c-b]}function N(a){if(!a.length)return a;var b=a.length-1;if("dot"===a[b].type)return[];if(1<b&&"fun"===a[b].type&&"fun"===a[b-1].token)return a.slice(0,b-1);switch(a[b].token){case "}":return k(a,{g:["{"]});case "]":return k(a,{i:["["]});case ")":return k(a,{i:["("]});case ">>":return k(a,{i:["<<"]});case "end":return k(a,{i:"begin case fun if receive try".split(" ")});case ",":return k(a,{e:"begin try when -> , ( [ { <<".split(" ")});
case "->":return k(a,{r:["when"],m:["try","if","case","receive"]});case ";":return k(a,{E:"case fun if receive try when".split(" ")});case "catch":return k(a,{e:["try"]});case "of":return k(a,{e:["case"]});case "after":return k(a,{e:["receive","try"]});default:return a}}function k(a,b){for(var c in b)for(var d=a.length-1,f=b[c],h=d-1;-1<h;h--)if(g(a[h].token,f)){var n=a.slice(0,h);switch(c){case "m":return n.concat(a[h]).concat(a[d]);case "r":return n.concat(a[d]);case "i":return n;case "g":return a=
n,a.concat.call(a,{token:"group",column:0,indent:0,type:"group"});case "E":return n.concat(a[h]);case "e":return n.concat(a[h])}}return"E"==c?[]:a}function O(a,b){var c,d=z.indentUnit;b=b.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/);b=m(b)&&0===b.index?b[0]:"";var f=p(a,1),h=p(a,2);if(a.in_string||a.in_atom)return l.Pass;if(h){if("when"==f.token)return f.column+d;if("when"===b&&"function"===h.type)return h.indent+d;if("("===b&&"fun"===f.token)return f.column+3;if("catch"===b&&(c=v(a,["try"])))return c.column;
if(g(b,["end","after","of"]))return(c=v(a,"begin case fun if receive try".split(" ")))?c.column:l.Pass;if(g(b,x))return(c=v(a,u))?c.column:l.Pass;if(g(f.token,[",","|","||"])||g(b,[",","|","||"]))return a=a.tokenStack.slice(0,-1),c=t(a,"type",["open_paren"]),(c=m(a[c])?a[c]:!1)?c.column+c.token.length:d;if("->"==f.token)return g(h.token,["receive","case","if","try"])?h.column+d+d:h.column+d;if(g(f.token,u))return f.column+f.token.length;a=a.tokenStack;c=t(a,"type",["open_paren","separator","keyword"]);
b=t(a,"type",["operator"]);c=m(c)&&m(b)&&c<b?a[c+1]:m(c)?a[c]:!1;return m(c)?c.column+d:0}return 0}function v(a,b){a=a.tokenStack;b=t(a,"token",b);return m(a[b])?a[b]:!1}function t(a,b,c){for(var d=a.length-1;-1<d;d--)if(g(a[d][b],c))return d;return!1}function m(a){return!1!==a&&null!=a}var B=["-type","-spec","-export_type","-opaque"],D="after begin catch case cond end fun if let of query receive try when".split(" "),J=/[\->,;]/,K=["->",";",","],E="and andalso band bnot bor bsl bsr bxor div not or orelse rem xor".split(" "),
L=/[\+\-\*\/<>=\|:!]/,M="= + - * / > >= < =< =:= == =/= /= || <- !".split(" "),H=/[<\(\[\{]/,u=["<<","(","[","{"],I=/[>\)\]\}]/,x=["}","]",")",">>"],G="is_atom is_binary is_bitstring is_boolean is_float is_function is_integer is_list is_number is_pid is_port is_record is_reference is_tuple atom binary bitstring boolean function integer list number pid port record reference tuple".split(" "),F="abs adler32 adler32_combine alive apply atom_to_binary atom_to_list binary_to_atom binary_to_existing_atom binary_to_list binary_to_term bit_size bitstring_to_list byte_size check_process_code contact_binary crc32 crc32_combine date decode_packet delete_module disconnect_node element erase exit float float_to_list garbage_collect get get_keys group_leader halt hd integer_to_list internal_bif iolist_size iolist_to_binary is_alive is_atom is_binary is_bitstring is_boolean is_float is_function is_integer is_list is_number is_pid is_port is_process_alive is_record is_reference is_tuple length link list_to_atom list_to_binary list_to_bitstring list_to_existing_atom list_to_float list_to_integer list_to_pid list_to_tuple load_module make_ref module_loaded monitor_node node node_link node_unlink nodes notalive now open_port pid_to_list port_close port_command port_connect port_control pre_loaded process_flag process_info processes purge_module put register registered round self setelement size spawn spawn_link spawn_monitor spawn_opt split_binary statistics term_to_binary time throw tl trunc tuple_size tuple_to_list unlink unregister whereis".split(" "),
r=/[\w@\u00d8-\u00de\u00c0-\u00d6\u00df-\u00f6\u00f8-\u00ff]/,C=/[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;return{startState:function(){return{tokenStack:[],in_string:!1,in_atom:!1}},token:function(a,b){return A(a,b)},indent:function(a,b){return O(a,b)},lineComment:"%"}})});
