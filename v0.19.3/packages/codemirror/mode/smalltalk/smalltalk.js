(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){f.defineMode("smalltalk",function(k){var l=/[+\-\/\\*~<>=@%|&?!.,:;^]/,t=/true|false|nil|self|super|thisContext/,g=function(a,b){this.next=a;this.parent=b},h=function(a,b,d){this.name=a;this.context=b;this.eos=d},n=function(){this.context=new g(m,null);this.expectVariable=!0;this.userIndentationDelta=
this.indentation=0};n.prototype.userIndent=function(a){this.userIndentationDelta=0<a?a/k.indentUnit-this.indentation:0};var m=function(a,b,d){var c=new h(null,b,!1),e=a.next();'"'===e?c=p(a,new g(p,b)):"'"===e?c=q(a,new g(q,b)):"#"===e?"'"===a.peek()?(a.next(),c=r(a,new g(r,b))):a.eatWhile(/[^\s.{}\[\]()]/)?c.name="string-2":c.name="meta":"$"===e?("<"===a.next()&&(a.eatWhile(/[^\s>]/),a.next()),c.name="string-2"):"|"===e&&d.expectVariable?c.context=new g(u,b):/[\[\]{}()]/.test(e)?(c.name="bracket",
c.eos=/[\[{(]/.test(e),"["===e?d.indentation++:"]"===e&&(d.indentation=Math.max(0,d.indentation-1))):l.test(e)?(a.eatWhile(l),c.name="operator",c.eos=";"!==e):/\d/.test(e)?(a.eatWhile(/[\w\d]/),c.name="number"):/[\w_]/.test(e)?(a.eatWhile(/[\w\d_]/),c.name=d.expectVariable?t.test(a.current())?"keyword":"variable":null):c.eos=d.expectVariable;return c},p=function(a,b){a.eatWhile(/[^"]/);return new h("comment",a.eat('"')?b.parent:b,!0)},q=function(a,b){a.eatWhile(/[^']/);return new h("string",a.eat("'")?
b.parent:b,!1)},r=function(a,b){a.eatWhile(/[^']/);return new h("string-2",a.eat("'")?b.parent:b,!1)},u=function(a,b){var d=new h(null,b,!1);"|"===a.next()?(d.context=b.parent,d.eos=!0):(a.eatWhile(/[^|]/),d.name="variable");return d};return{startState:function(){return new n},token:function(a,b){b.userIndent(a.indentation());if(a.eatSpace())return null;a=b.context.next(a,b.context,b);b.context=a.context;b.expectVariable=a.eos;return a.name},blankLine:function(a){a.userIndent(0)},indent:function(a,
b){b=a.context.next===m&&b&&"]"===b.charAt(0)?-1:a.userIndentationDelta;return(a.indentation+b)*k.indentUnit},electricChars:"]"}});f.defineMIME("text/x-stsrc",{name:"smalltalk"})});
